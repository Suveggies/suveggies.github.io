<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="./malware.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <title>Jacob Suveges Portfolio</title>
    </head>
    <body>
        <div id="transition" class="hidden">
            <ul class="navul">
                <li class="navli"><a href="https://suveggies.github.io/">Back To Directory</a></li>
                <li class="navli"><a href="https://suveggies.github.io/portfolio/">Home</a></li>
                <li class="navli"><a href="https://suveggies.github.io/portfolio/analysis_reports/">Analysis Reports</a></li>
                <li class="navli"><a href="https://suveggies.github.io/portfolio/practical_malware/">Malware Analysis Reports</a></li>
                <li class="navli"><a href="https://suveggies.github.io/portfolio/competition_reports/">Competition Score Reports</a></li>
                <li class="navli"><a href="https://suveggies.github.io/portfolio/ctf_writeups/">CTF Writeups</a></li>
            </ul>
            <h1>Practical Malware Analysis Labs</h1>
            <div class="chapters">
                <h3>Chapter 1 - Basic Static Techniques</h3>
                <details>
                    <summary>Question 1</summary>
                    <ol>
                        <li class="answer">DLL scores 37/70 on VirusTotal as most likely a trojan. Executable scores 51/71 on VirusTotal as a trojan.</li>
                        <li class="answer">Compiled on December 19, 2010.</li>
                        <li class="answer">There are no indicators to indicate that the executable was packed. It has a large disk size and I can view the DLL functions imported.</li>
                        <li class="answer">MapViewOfFile and CreateFileMappingA are used by launchers, loaders, and injectors to read and modify PE files. CreateAFileA creates a file or opens an existing one. FindFirstFileA and FindNextFileA are used to enumerate the filesystem and search the directory. FindClose closes a file search handle. CopyFileA copies an existing file to a new file. This malware will create and scan for files it creates and modifies. CreateMutex and OpenMutex allow the malware to only create one instance of itself. Sleep allows the malware to wait until something occurs.</li>
                        <li class="answer">Creates this file kerne132.dll which is meant to resemble the actual kernel32.dll, 127.26.152.13 is found inside the dll by looking at the strings.</li>
                        <li class="answer">It may be a backdoor that is being accessed by the IP address 127.26.152.13. It’s meant to be stealthy as it creates the file kerne132.dll and the malware itself is most likely meant to be dormant until the user connects to the machine from the IP. This would also explain why they would only want one instance of the malware to be running.</li>
                    </ol>
                </details>
                <details>
                    <summary>Question 2</summary>
                    <ol>
                        <li class="answer">This scores a 58/72 on VirusTotal.  It says it is a trojan.</li>
                        <li class="answer">According to PEiD, this malware was packed with UPX.</li>
                        <li class="answer">The program will load libraries with LoadLibraryA. Then it will create a service with CreateServiceA. Then it will connect to the internet in some way due to InternetOpen. If we unpack the executable we find that it can open a URL with InternetOpenURLA.</li>
                        <li class="answer">The malware will connect to http://www.malwareanalysisbook.com on Internet Explorer 8.0. It also creates a service called MalService.</li>
                    </ol>
                </details>
                <details>
                    <summary>Question 3</summary>
                    <ol>
                        <li class="answer">This scores a 65/71 on VirusTotal. It’s marked as a trojan.</li>
                        <li class="answer">According to PEiD, it is packed with FSG 1.0. Able to unpack with unipacker.</li>
                        <li class="answer">COM library is being called with the OLEInitialize function. COM objects can be created through CoCreateInstance. Strings can be allocated and unallocated through the SysAllocString and SysFreeString functions.</li>
                        <li class="answer">http://www.malwareanalysisbook.com/ad.html is found within the malware.</li>
                    </ol>
                </details>
                <details>
                    <summary>Question 4</summary>
                    <ol>
                        <li class="answer">This scores 62/71 on VirusTotal. Marked as a Trojan Downloader.</li>
                        <li class="answer">No indication that it is packed.</li>
                        <li class="answer">It was compiled on this date and time 2019-08-30 15:26:59.</li>
                        <li class="answer">Accesses DLL functions that the computer has stored in memory. (GetProcAddress, LoadLibraryA) Executes a program. (WinExec) Creates a new or existing file and writes to it. (WriteFile, CreateFile) Possibly injects code into another process. (CreateRemoteThread) Able to find resources and check their size. (SizeofResource, FindResource) Searches the computer for a place to inject code. (GetModuleHandle, GetWindowsDirectory) Writes to a temporary file and moves it to the place it determined to inject code. (MoveFile, GetTempPath) Stores stuff into memory. (LoadResource) Able to gain additional permissions. (AdjustTokenPrivileges)</li>
                        <li class="answer">The following references can be found in the file: winlogon.exe, \system32\wupdmgr.exe, \winup.exe, http://www.practicalmalwareanalysis.com/updater.exe</li>
                        <li class="answer">The resource in the file is another PE which is to download the updater from practicalmalwareanalysis.com. (URLDownloadToFile)</li>
                    </ol>
                </details>
            </div>
            <div class="chapters">
                <h3>Chapter 2 - Malware Analysis In Virtual Machines</h3>
                <p>No Questions</p>
            </div>
            <div class="chapters">
                <h3>Chapter 3 - Basic Dynamic Analysis</h3>
                <p>Question 1</p>
                <p>Question 2</p>
                <p>Question 3</p>
                <p>Question 4</p>
            </div>
        </div>
        <script type="text/javascript" src="index.js"></script>
    </body>
</html>